# Palmpay爬虫打包指南

## 打包结果

### macOS平台
- **可执行文件**: `dist/PalmpayCrawler`
- **文件大小**: 约102MB
- **架构**: arm64 (适用于Apple Silicon芯片)
- **状态**: ✅ 打包成功，测试通过
- **功能**: ✅ 自动安装Playwright浏览器驱动

### Windows平台
- **打包方法**: 在Windows系统上使用相同命令
- **预期文件**: `dist/PalmpayCrawler.exe`
- **架构**: x86-64
- **功能**: ✅ 自动安装Playwright浏览器驱动

## 使用说明

### macOS系统
1. **首次运行**:
   - 双击 `PalmpayCrawler` 文件
   - 或在终端中执行:
     ```bash
     ./PalmpayCrawler
     ```
   - 程序会自动检查并安装Playwright浏览器驱动
   - 等待安装完成后，应用会自动启动

2. **使用流程**:
   - 应用启动后会显示Qt GUI界面
   - 点击"启动浏览器"按钮打开登录页面
   - 在浏览器中完成Palmpay商户后台登录
   - 登录成功后，点击"启动爬虫"开始爬取数据
   - 爬取完成后，数据会导出到 `./data` 目录的CSV文件中

### Windows系统
1. **首次运行**:
   - 双击 `PalmpayCrawler.exe` 文件
   - 或在命令提示符中执行:
     ```cmd
     PalmpayCrawler.exe
     ```
   - 程序会自动检查并安装Playwright浏览器驱动
   - 等待安装完成后，应用会自动启动

2. **使用流程**:
   - 与macOS系统相同

## 注意事项

1. **浏览器驱动自动安装**:
   - 程序首次运行时会自动检查Playwright浏览器驱动
   - 如果驱动未安装，程序会自动下载并安装
   - 安装过程可能需要几分钟，请耐心等待
   - 如果自动安装失败，可以手动执行:
     ```bash
     playwright install chromium
     ```

2. **权限问题**:
   - macOS可能会提示"无法打开，因为它来自身份不明的开发者"
   - 解决方案: 右键点击应用 → 选择"打开" → 确认打开

3. **数据存储**:
   - 爬取的数据会保存在 `./data` 目录
   - CSV文件名包含时间戳，格式: `YYYYMMDD_HHMMSS_order_details.csv`

4. **配置文件**:
   - 应用会自动加载同目录下的 `.env` 文件
   - 如需修改配置，可编辑此文件

5. **网络要求**:
   - 需要稳定的网络连接
   - 可能需要VPN访问Palmpay商户后台
   - 首次运行需要下载浏览器驱动（约300MB）

## 常见问题

### Q: 应用启动后显示"正在检查Playwright浏览器驱动..."
**A**: 这是正常现象，程序正在检查并自动安装浏览器驱动，请耐心等待

### Q: 应用启动后显示"Playwright浏览器驱动安装超时"
**A**: 网络连接可能较慢，可以手动执行 `playwright install chromium` 安装

### Q: 登录成功后无法获取认证信息
**A**: 请确保在商户后台登录成功，并且页面已加载完成

### Q: 爬取过程中出现"server busy"错误
**A**: 系统已内置重试机制，会自动处理此类错误

### Q: 停止爬虫按钮无响应
**A**: 请等待当前操作完成，或强制关闭应用后重新启动

## 技术支持

如遇到其他问题，请联系开发者提供技术支持。

---

**版本**: 1.0.0
**更新日期**: 2026-01-30
**适用平台**: macOS (arm64), Windows (x86-64)
**新功能**: 自动安装Playwright浏览器驱动